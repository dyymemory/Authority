var DepartmentIndex = {
    TabType1: true,//U+门前权限第一次加载
    TabType2: true,//U+地理权限第一次加载
    TabDivisition1: true,//门店管辖-能看我的第一次加载
    TabDept1: true,//U+门前权限-能看我的第一次加载
    TabArea1: true,//U+地理权限-能看我的第一次加载
    TypeCodeSelected: "",//U+门店权限我能看的 radio 选中的
    DepartOnlyCodeSelected: "",// U+门店权限面板 主树选择的部门
    AreaTypeCodeSelected: "",//U+地理权限我能看的 radio 选中的
    AreaDepartOnlyCodeSelected: "",//U+地理权限面板 主树选择的部门
    DivisitionCanSeeSelectedNodes: [],//管辖权限我能看的部门树选中节点
    DivisitionBeSeenSelectedNodes: [],//管辖权限能看我的部门树选中节点
    FySelCanSeeSelectedNodes: [],//查看房源我能看的部门树选中节点
    FySelBeSeenSelectedNodes: [],//查看房源能看我的部门树选中节点
    CustSelCanSeeSelectedNodes: [],//查看客源我能看的部门树选中节点
    CustSelBeSeenSelectedNodes: [],//查看客源能看我的部门树选中节点
    PublicOwnerCanSeeSelectedNodes: [],//公盘看业主我能看的部门树选中节点
    PublicOwnerBeSeenSelectedNodes: [],//公盘看业主能看我的部门树选中节点
    PrivateOwnerCanSeeSelectedNodes: [],//私盘看业主我能看的部门树选中节点
    PrivateOwnerBeSeenSelectedNodes: [],//私盘看业主能看我的部门树选中节点
    CommonOwnerCanSeeSelectedNodes: [],//公共池房源看业主我能看的部门树选中节点
    CommonOwnerBeSeenSelectedNodes: [],//公共池房源看业主能看我的部门树选中节点
    FyFellowCanSeeSelectedNodes: [],//房源看跟进我能看的部门树选中节点
    FyFellowBeSeenSelectedNodes: [],//房源看跟进能看我的部门树选中节点
    CustFellowCanSeeSelectedNodes: [],//客源看跟进我能看的部门树选中节点
    CustFellowBeSeenSelectedNodes: [],//客源看跟进能看我的部门树选中节点
    AreaFySelCanSeeSelectedNodes: [],//片区查看房源我能看的部门树选中节点
    AreaFySelBeSeenSelectedNodes: [],//片区查看房源能看我的部门树选中节点
    AreaFyModifyCanSeeSelectedNodes: [],//片区维护房源我能看的部门树选中节点
    AreaFyModifyBeSeenSelectedNodes: [],//片区维护房源能看我的部门树选中节点
    AreaCustSelCanSeeSelectedNodes: [],//片区查看客源我能看的部门树选中节点
    AreaCustSelBeSeenSelectedNodes: [],//片区查看客源能看我的部门树选中节点
    AreaFyInfoCanSeeSelectedNodes: [],//片区资料房源我能看的部门树选中节点
    AreaFyInfoBeSeenSelectedNodes: [],//片区资料房源能看我的部门树选中节点
    UplusCanSeeSelectedNodes: { FySel: [], CustSel: [], PublicOwner: [], PrivateOwner: [], CommonOwner: [], FyFellow: [], CustFellow: [] },//U+系统我能看的部门树选中节点
    UplusAreaCanSeeSelectedNodes: { FySel: [], FyModify: [], CustSel: [], FyInfo: [] },//U+系统我能看的片区树选中节点
    Init: function () {
        layui.use(['element', 'form', 'layer'], function () {
            var element = layui.element,
                form = layui.form,
                layer = layui.layer;

            ControlComm.CityBinding($('#City'), form);

            var cityChange = function () {
                layui.use('form', function () {
                    var form = layui.form;
                    ControlComm.DepartmentBinding($('#Department'), form, $('#City').val());
                    if (PrivComm.CheckAuthority('priv-deptauth-query')) {
                        DepartmentIndex.GetDeptTreeNoCheck($('#deptTree'), $('#City').val());
                    }
                });
            };
            form.on('select(City)', cityChange);
            form.on('select(Department)', function () {
                var listSorted = DepartmentIndex.GetTreeListSorted($('#Department').find('option:selected').eq(0), CacheHelper.GetDepartment($('#City').val()));
                DepartmentIndex.GetDeptTreeNoCheck($('#deptTree'), $('#City').val(), listSorted);
            });

            //$('#Search').on('click', function () {
            //    var param = {};
            //    if (!$('#City').val()) {
            //        layer.msg("请选择城市");
            //        return;
            //    } else {
            //        param.CityID = $('#City').val();
            //    }
            //    DepartmentIndex.GetDeptTreeNoCheck($('#deptTree'), param);
            //});

            //面板监听事件
            $('.site-demo-active').on('click', function () {
                var othis = $(this), type = othis.data('type');
                active[type] ? active[type].call(this, othis) : '';
            });

            //管辖权限-U+门店权限-U+地理权限面板监听事件
            element.on('tab(TabType)', function (data) {
                //U+门店权限-我能看的
                if (DepartmentIndex.TabType1 && data.index == 1) {
                    DepartmentIndex.TabType1 = false;
                    DepartmentIndex.InitUplusDeptCanSee(form);
                }
                    //U+地理权限-我能看的
                else if (DepartmentIndex.TabType2 && data.index == 2) {
                    DepartmentIndex.TabType2 = false;
                    DepartmentIndex.InitUplusAreaCanSee(form);
                }
            });

            //管辖权限--能看我的面板事件
            element.on('tab(TabDivisition)', function (data) {
                if (DepartmentIndex.TabDivisition1 && data.index == 1) {
                    DepartmentIndex.TabDivisition1 = false;
                    DepartmentIndex.InitDivisitionBeSeen(form);
                }
            });

            //U+门店权限--能看我的面板事件
            element.on('tab(TabDept)', function (data) {
                if (DepartmentIndex.TabDept1 && data.index == 1) {
                    DepartmentIndex.TabDept1 = false;
                    DepartmentIndex.InitUplusDeptBeSeen(form);
                }
            });

            //U+地理权限--能看我的面板事件
            element.on('tab(TabArea)', function (data) {
                if (DepartmentIndex.TabArea1 && data.index == 1) {
                    DepartmentIndex.TabArea1 = false;
                    DepartmentIndex.InitUplusAreaBeSeen(form);
                }
            });
            
            $('#City').val(CacheHelper.GetUser().CityID);
            cityChange();
            DepartmentIndex.InitDivisitionCanSee(form);
            form.render();
        });
    },
    //门店管辖我能看的事件监听
    InitDivisitionCanSee: function (form) {
        ControlComm.CityBinding($('#CityDivisitionCanSee'), form);
        var cityDivisitionCanSeeChange = function () {
            ControlComm.DepartmentBinding($('#DepartmentDivisitionCanSee'), form, $('#CityDivisitionCanSee').val());
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDivisitionCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': ['dep-divisition-sel'], 'ViewType': 1 }, true, function (result) {
                    DepartmentIndex.DivisitionCanSeeSelectedNodes = [];
                    if (!!result) {
                        layui.each(result.Data, function () {
                            DepartmentIndex.DivisitionCanSeeSelectedNodes.push(this.DataCode);
                        });
                    }
                    ControlComm.GetDeptTree($('#TreeDivisitionCanSee'), $('#CityDivisitionCanSee').val(), DepartmentIndex.DivisitionCanSeeSelectedNodes);
                });
            } else {
                ControlComm.GetDeptTree($('#TreeDivisitionCanSee'), $('#CityDivisitionCanSee').val());
            }
        };
        form.on('select(CityDivisitionCanSee)', cityDivisitionCanSeeChange);
        form.on('select(DepartmentDivisitionCanSee)', function () {
            DepartmentIndex.RefreshSelectedNodes("TreeDivisitionCanSee", DepartmentIndex.DivisitionCanSeeSelectedNodes);
            var listSorted = $('#DepartmentDivisitionCanSee').val() == '' ? null : DepartmentIndex.GetTreeListSorted($('#DepartmentDivisitionCanSee').find('option:selected').eq(0), CacheHelper.GetDepartment($('#CityDivisitionCanSee').val()));
            ControlComm.GetDeptTree($('#TreeDivisitionCanSee'), $('#CityDivisitionCanSee').val(), DepartmentIndex.DivisitionCanSeeSelectedNodes, listSorted);
        });
        $('#SaveDivisitionCanSee').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }
            DepartmentIndex.RefreshSelectedNodes("TreeDivisitionCanSee", DepartmentIndex.DivisitionCanSeeSelectedNodes);
            var param = {};
            param.DepartOnlyCode = dept.DepartOnlyCode;
            param.CityID = $('#CityDivisitionCanSee').val();
            param.DepDivisitionSel = DepartmentIndex.DivisitionCanSeeSelectedNodes;
            param.TypeCodeList = ['dep-divisition-sel'];
            param.ViewType = 1;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#CheckedAllDivisitionCanSee').on('click', function () {
            DepartmentIndex.CheckAllNodes("TreeDivisitionCanSee", true);
        });
        $('#UnCheckedAllDivisitionCanSee').on('click', function () {
            DepartmentIndex.CheckAllNodes("TreeDivisitionCanSee", false);
        });

        $('#CityDivisitionCanSee').val(CacheHelper.GetUser().CityID);
        cityDivisitionCanSeeChange();
    },
    //门店管辖能看我的事件监听
    InitDivisitionBeSeen: function (form) {
        ControlComm.CityBinding($('#CityDivisitionBeSeen'), form);
        var cityDivisitionBeSeenChange = function () {
            ControlComm.DepartmentBinding($('#DepartmentDivisitionBeSeen'), form, $('#CityDivisitionBeSeen').val());
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDivisitionBeSeen').val(), 'DataCode': dept.DepartOnlyCode, 'TypeCodeList': ['dep-divisition-sel'], 'ViewType': 2 }, true, function (result) {
                    DepartmentIndex.DivisitionBeSeenSelectedNodes = [];
                    if (!!result) {
                        layui.each(result.Data, function () {
                            DepartmentIndex.DivisitionBeSeenSelectedNodes.push(this.DepartOnlyCode);
                        });
                    }
                    ControlComm.GetDeptTree($('#TreeDivisitionBeSeen'), $('#CityDivisitionBeSeen').val(), DepartmentIndex.DivisitionBeSeenSelectedNodes);
                });
            } else {
                ControlComm.GetDeptTree($('#TreeDivisitionBeSeen'), $('#CityDivisitionBeSeen').val());
            }
        };

        form.on('select(CityDivisitionBeSeen)', cityDivisitionBeSeenChange);
        form.on('select(DepartmentDivisitionBeSeen)', function () {
            DepartmentIndex.RefreshSelectedNodes("TreeDivisitionBeSeen", DepartmentIndex.DivisitionBeSeenSelectedNodes);
            var listSorted = $('#DepartmentDivisitionBeSeen').val() == '' ? null : DepartmentIndex.GetTreeListSorted($('#DepartmentDivisitionBeSeen').find('option:selected').eq(0), CacheHelper.GetDepartment($('#CityDivisitionBeSeen').val()));
            ControlComm.GetDeptTree($('#TreeDivisitionBeSeen'), $('#CityDivisitionBeSeen').val(), DepartmentIndex.DivisitionBeSeenSelectedNodes, listSorted);
        });
        $('#SaveDivisitionBeSeen').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }
            DepartmentIndex.RefreshSelectedNodes("TreeDivisitionBeSeen", DepartmentIndex.DivisitionBeSeenSelectedNodes);
            var param = {};
            param.DataCode = dept.DepartOnlyCode;
            param.CityID = $('#CityDivisitionBeSeen').val();
            param.DepDivisitionSel = DepartmentIndex.DivisitionBeSeenSelectedNodes;
            param.ViewType = 2;
            param.TypeCodeList = ['dep-divisition-sel'];
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#CheckedAllDivisitionBeSeen').on('click', function () {
            DepartmentIndex.CheckAllNodes("TreeDivisitionBeSeen", true);
        });
        $('#UnCheckedAllDivisitionBeSeen').on('click', function () {
            DepartmentIndex.CheckAllNodes("TreeDivisitionBeSeen", false);
        });

        $('#CityDivisitionBeSeen').val(CacheHelper.GetUser().CityID);
        cityDivisitionBeSeenChange();
    },
    //U+门店权限设置我能看的
    InitUplusDeptCanSee: function (form) {
        ControlComm.CityBinding($('#CityDeptCanSee'), form);
        $('input:radio[name=TypeCode][value="all"]').prop("checked", true);
        var cityDeptCanSeeChange = function () {
            ControlComm.DepartmentBinding($('#DepartmentDeptCanSee'), form, $('#CityDeptCanSee').val());
            var typeCode = $('input:radio[name=TypeCode]:checked').val();
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 1 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusCanSeeSelectedNodes(typeCode, data);
                    ControlComm.GetDeptTree($('#deptDataTree'), $('#CityDeptCanSee').val(), DepartmentIndex.GetUplusCanSeeSelectedNodesByTypeCode(typeCode));
                });
            } else {
                ControlComm.GetDeptTree($('#deptDataTree'), $('#CityDeptCanSee').val());
            }

            if (!!dept && dept.DepartOnlyCode > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': ['dep-fy-sel', 'dep-cust-sel', 'dep-public-owner', 'dep-private-owner', 'dep-common-owner', 'dep-fy-fellow', 'dep-cust-fellow'], 'ViewType': 1 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.BatchRefreshUplusCanSeeSelectedNodes(data);

                    DepartmentIndex.GetTreeTable(form, $('#CityDeptCanSee').val(), DepartmentIndex.UplusCanSeeSelectedNodes);
                });
            } else {
                DepartmentIndex.GetTreeTable(form, $('#CityDeptCanSee').val());
            }

        };

        form.on('select(CityDeptCanSee)', cityDeptCanSeeChange);
        form.on('select(DepartmentDeptCanSee)', function () {
            var listSorted = $('#DepartmentDeptCanSee').val() == '' ? null : DepartmentIndex.GetTreeListSorted($('#DepartmentDeptCanSee').find('option:selected').eq(0), CacheHelper.GetDepartment($('#CityDeptCanSee').val()));

            var typeCode = $('input:radio[name=TypeCode]:checked').val();
            var arrDept = DepartmentIndex.GetUplusCanSeeSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshSelectedNodes("deptDataTree", arrDept);
            ControlComm.GetDeptTree($('#deptDataTree'), $('#CityDeptCanSee').val(), arrDept, listSorted);

            DepartmentIndex.RefreshTreeTableSelectedNodes(DepartmentIndex.UplusCanSeeSelectedNodes);
            DepartmentIndex.GetTreeTable(form, $('#CityDeptCanSee').val(), DepartmentIndex.UplusCanSeeSelectedNodes, listSorted);
        });
        $('#SaveTreeTable').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }

            DepartmentIndex.RefreshTreeTableSelectedNodes(DepartmentIndex.UplusCanSeeSelectedNodes);
            var param = {};
            param.DepartOnlyCode = dept.DepartOnlyCode;
            param.CityID = $('#CityDeptCanSee').val();
            param.DepFySel = DepartmentIndex.UplusCanSeeSelectedNodes.FySel;
            param.DepCustSel = DepartmentIndex.UplusCanSeeSelectedNodes.CustSel;
            param.DepPublicOwner = DepartmentIndex.UplusCanSeeSelectedNodes.PublicOwner;
            param.DepPrivateOwner = DepartmentIndex.UplusCanSeeSelectedNodes.PrivateOwner;
            param.DepCommonOwner = DepartmentIndex.UplusCanSeeSelectedNodes.CommonOwner;
            param.DepFyFellow = DepartmentIndex.UplusCanSeeSelectedNodes.FyFellow;
            param.DepCustFellow = DepartmentIndex.UplusCanSeeSelectedNodes.CustFellow;
            param.TypeCodeList = ['dep-fy-sel', 'dep-cust-sel', 'dep-public-owner', 'dep-private-owner', 'dep-common-owner', 'dep-fy-fellow', 'dep-cust-fellow'];
            param.ViewType = 1;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#SaveTypeCode').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }

            var typeCode = $('input:radio[name=TypeCode]:checked').val();
            var paramName = DepartmentIndex.GetUplusParamNameByTypeCode(typeCode);
            var arrDept = DepartmentIndex.GetUplusCanSeeSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshSelectedNodes("deptDataTree", arrDept);
            var param = {};
            param.DepartOnlyCode = dept.DepartOnlyCode;
            param.CityID = $('#CityDeptCanSee').val();
            param[paramName] = arrDept;
            param.TypeCodeList = [typeCode];
            param.ViewType = 1;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        // U+门店权限 我能看的 复制权限到门店
        $('#CopyTypeCode').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            console.log(dept);
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }
            DepartmentIndex.DepartOnlyCodeSelected = dept.DepartOnlyCode;
            var treeObj = $.fn.zTree.getZTreeObj("deptDataTree");
            if (!!treeObj) {
                var CityID = $('#CityDeptCanSee').val();
                var DeptID = $("#DepartmentDeptCanSee").val();
                layui.use("layer", function () {
                    var layer = layui.layer;
                    layer.open({
                        type: 2,
                        title: '',
                        area: ['53%', '80%'], //宽高
                        content: 'department/department_copyprivtodep.html#' + CityID + '',
                        scrollbar: false,//禁用滚动条
                        btnAlign: 'd'
                    });
                });
            };
        });
        $('#CheckedAllTypeCode').on('click', function () {
            DepartmentIndex.CheckAllNodes("deptDataTree", true);
        });
        $('#UnCheckedAllTypeCode').on('click', function () {
            DepartmentIndex.CheckAllNodes("deptDataTree", false);
        });

        $('#oneType').hide();
        //U+门店权限我能看的radio事件
        form.on('radio(TypeCode)', function () {
            var typeCode = $('input:radio[name=TypeCode]:checked').val();
            DepartmentIndex.TypeCodeSelected = typeCode;
            if (typeCode == 'all') {
                $('#allType').show();
                $('#oneType').hide();

                var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
                if (!!dept && dept.DepartOnlyCode > 0) {
                    if ($("#treeTable tbody").children().length > 0) {
                        PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': ['dep-fy-sel', 'dep-cust-sel', 'dep-public-owner', 'dep-private-owner', 'dep-common-owner', 'dep-fy-fellow', 'dep-cust-fellow'], 'ViewType': 1 }, true, function (result) {
                            var data = [];
                            if (!!result) {
                                data = result.Data;
                            }
                            DepartmentIndex.BatchRefreshUplusCanSeeSelectedNodes(data);
                            $('input:checkbox[TypeCode="dep-fy-sel"]').prop('checked', false);
                            $('input:checkbox[TypeCode="dep-cust-sel"]').prop('checked', false);
                            $('input:checkbox[TypeCode="dep-public-owner"]').prop('checked', false);
                            $('input:checkbox[TypeCode="dep-private-owner"]').prop('checked', false);
                            $('input:checkbox[TypeCode="dep-common-owner"]').prop('checked', false);
                            $('input:checkbox[TypeCode="dep-fy-fellow"]').prop('checked', false);
                            $('input:checkbox[TypeCode="dep-cust-fellow"]').prop('checked', false);
                            DepartmentIndex.SetTreeTableStatus(DepartmentIndex.UplusCanSeeSelectedNodes);
                            layui.use('form', function () {
                                layui.form.render('checkbox');
                            });
                        });
                    }
                }

            } else {
                $('#allType').hide();
                $('#oneType').show();

                var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
                if (!!dept && dept.DepartOnlyCode > 0) {
                    var deptDataTree = $.fn.zTree.getZTreeObj("deptDataTree");
                    if (!!deptDataTree) {
                        PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 1 }, true, function (result) {
                            deptDataTree.checkAllNodes(false);
                            var data = [];
                            if (!!result) {
                                for (var i = 0; i < result.Data.length; i++) {
                                    var node = deptDataTree.getNodeByParam("DepartOnlyCode", result.Data[i].DataCode);
                                    if (node != null) {
                                        deptDataTree.checkNode(node, true);
                                    }
                                };
                                data = result.Data;
                            }
                            DepartmentIndex.RefreshUplusCanSeeSelectedNodes(typeCode, data);
                        });
                    }
                }

            }
        });

        $('#CityDeptCanSee').val(CacheHelper.GetUser().CityID);
        cityDeptCanSeeChange();
    },
    //U+门店权限能看我的
    InitUplusDeptBeSeen: function (form) {
        ControlComm.CityBinding($('#CityDeptBeSeen'), form);
        $('input:radio[name=TypeCodeBeSeen][value="dep-fy-sel"]').prop("checked", true);
        var cityDeptBeSeenChange = function () {
            ControlComm.DepartmentBinding($('#DepartmentDeptBeSeen'), form, $('#CityDeptBeSeen').val());

            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                var typeCode = $('input:radio[name=TypeCodeBeSeen]:checked').val();
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptBeSeen').val(), 'DataCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 2 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusBeSeenSelectedNodes(typeCode, data);
                    ControlComm.GetDeptTree($('#deptDataTreeBeSeen'), $('#CityDeptBeSeen').val(), DepartmentIndex.GetUplusBeSeenSelectedNodesByTypeCode(typeCode));
                });
            } else {
                ControlComm.GetDeptTree($('#deptDataTreeBeSeen'), $('#CityDeptBeSeen').val());
            }
        };

        form.on('select(CityDeptBeSeen)', cityDeptBeSeenChange);
        form.on('select(DepartmentDeptBeSeen)', function () {
            var listSorted = $('#DepartmentDeptBeSeen').val() == '' ? null : DepartmentIndex.GetTreeListSorted($('#DepartmentDeptBeSeen').find('option:selected').eq(0), CacheHelper.GetDepartment($('#CityDeptBeSeen').val()));

            var typeCode = $('input:radio[name=TypeCodeBeSeen]:checked').val();
            var arrDept = DepartmentIndex.GetUplusBeSeenSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshSelectedNodes("deptDataTreeBeSeen", arrDept);
            ControlComm.GetDeptTree($('#deptDataTreeBeSeen'), $('#CityDeptBeSeen').val(), arrDept, listSorted);
        });
        $('#SaveTypeCodeBeSeen').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }

            var typeCode = $('input:radio[name=TypeCodeBeSeen]:checked').val();
            var paramName = DepartmentIndex.GetUplusParamNameByTypeCode(typeCode);
            var arrDept = DepartmentIndex.GetUplusBeSeenSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshSelectedNodes("deptDataTreeBeSeen", arrDept);
            var param = {};
            param.DataCode = dept.DepartOnlyCode;
            param.CityID = $('#CityDeptBeSeen').val();
            param[paramName] = arrDept;
            param.TypeCodeList = [typeCode];
            param.ViewType = 2;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#CheckedAllTypeCodeBeSeen').on('click', function () {
            DepartmentIndex.CheckAllNodes("deptDataTreeBeSeen", true);
        });
        $('#UnCheckedAllTypeCodeBeSeen').on('click', function () {
            DepartmentIndex.CheckAllNodes("deptDataTreeBeSeen", false);
        });

        //U+门店权限能看我的radio事件
        form.on('radio(TypeCodeBeSeen)', function () {
            var typeCode = $('input:radio[name=TypeCodeBeSeen]:checked').val();
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                var deptDataTreeBeSeen = $.fn.zTree.getZTreeObj("deptDataTreeBeSeen");
                if (!!deptDataTreeBeSeen) {
                    PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptBeSeen').val(), 'DataCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 2 }, true, function (result) {
                        deptDataTreeBeSeen.checkAllNodes(false);
                        var data = [];
                        if (!!result) {
                            for (var i = 0; i < result.Data.length; i++) {
                                var node = deptDataTreeBeSeen.getNodeByParam("DepartOnlyCode", result.Data[i].DepartOnlyCode);
                                if (node != null) {
                                    deptDataTreeBeSeen.checkNode(node, true);
                                }
                            };
                            data = result.Data;
                        }
                        DepartmentIndex.RefreshUplusBeSeenSelectedNodes(typeCode, data);
                    });
                }
            }
        });

        $('#CityDeptBeSeen').val(CacheHelper.GetUser().CityID);
        cityDeptBeSeenChange();
    },
    //U+片区权限我能看的
    InitUplusAreaCanSee: function (form) {
        ControlComm.CityBinding($('#CityAreaCanSee'), form);
        $('input:radio[name=TypeCodeArea][value="all-area"]').prop("checked", true);

        var cityAreaCanSeeChange = function () {
            ControlComm.AreaBinding($('#DepartmentAreaCanSee'), form, $('#CityAreaCanSee').val());
            var typeCode = $('input:radio[name=TypeCodeArea]:checked').val();
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 1 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusAreaCanSeeSelectedNodes(typeCode, data);
                    ControlComm.GetAreaTree($('#areaDataTree'), $('#CityAreaCanSee').val(), DepartmentIndex.GetUplusCanSeeSelectedNodesByTypeCode(typeCode));
                });
            } else {
                ControlComm.GetAreaTree($('#areaDataTree'), $('#CityAreaCanSee').val());
            }

            if (!!dept && dept.DepartOnlyCode > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': ['area-fy-sel', 'area-fy-modify', 'area-cust-sel', 'area-fy-info'], 'ViewType': 1 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.BatchRefreshUplusAreaCanSeeSelectedNodes(data);

                    DepartmentIndex.GetTreeTableArea(form, $('#CityAreaCanSee').val(), DepartmentIndex.UplusAreaCanSeeSelectedNodes);
                });
            } else {
                DepartmentIndex.GetTreeTableArea(form, $('#CityAreaCanSee').val());
            }
        };
        form.on('select(CityAreaCanSee)', cityAreaCanSeeChange);
        form.on('select(DepartmentAreaCanSee)', function () {
            var listSorted = $('#DepartmentAreaCanSee').val() == '' ? null : DepartmentIndex.GetAreaTreeListSorted($('#DepartmentAreaCanSee').find('option:selected').eq(0), CacheHelper.GetArea($('#CityAreaCanSee').val()));
            var typeCode = $('input:radio[name=TypeCodeArea]:checked').val();
            var arrArea = DepartmentIndex.GetUplusAreaCanSeeSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshAreaSelectedNodes("areaDataTree", arrArea);
            ControlComm.GetAreaTree($('#areaDataTree'), $('#CityAreaCanSee').val(), arrArea, listSorted);

            DepartmentIndex.RefreshTreeTableAreaSelectedNodes(DepartmentIndex.UplusAreaCanSeeSelectedNodes);
            DepartmentIndex.GetTreeTableArea(form, $('#CityAreaCanSee').val(), DepartmentIndex.UplusAreaCanSeeSelectedNodes, listSorted);
        });
        $('#SaveTreeTableArea').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }

            DepartmentIndex.RefreshTreeTableAreaSelectedNodes(DepartmentIndex.UplusAreaCanSeeSelectedNodes);
            var param = {};
            param.DepartOnlyCode = dept.DepartOnlyCode;
            param.CityID = $('#CityAreaCanSee').val();
            param.AreaFySel = DepartmentIndex.UplusAreaCanSeeSelectedNodes.FySel;
            param.AreaFyModify = DepartmentIndex.UplusAreaCanSeeSelectedNodes.FyModify;
            param.AreaCustSel = DepartmentIndex.UplusAreaCanSeeSelectedNodes.CustSel;
            param.AreaFyInfo = DepartmentIndex.UplusAreaCanSeeSelectedNodes.FyInfo;
            param.TypeCodeList = ['area-fy-sel', 'area-fy-modify', 'area-cust-sel', 'area-fy-info'];
            param.ViewType = 1;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#SaveTypeCodeArea').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }

            var typeCode = $('input:radio[name=TypeCodeArea]:checked').val();
            var paramName = DepartmentIndex.GetUplusAreaParamNameByTypeCode(typeCode);
            var arrArea = DepartmentIndex.GetUplusAreaCanSeeSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshAreaSelectedNodes("areaDataTree", arrArea);
            var param = {};
            param.DepartOnlyCode = dept.DepartOnlyCode;
            param.CityID = $('#CityAreaCanSee').val();
            param[paramName] = arrArea;
            param.TypeCodeList = [typeCode];
            param.ViewType = 1;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#CheckedAllTypeCodeArea').on('click', function () {
            DepartmentIndex.CheckAllNodes("areaDataTree", true);
        });
        $('#UnCheckedAllTypeCodeArea').on('click', function () {
            DepartmentIndex.CheckAllNodes("areaDataTree", false);
        });

        $('#oneTypeArea').hide();
        //U+片区权限我能看的radio事件
        form.on('radio(TypeCodeArea)', function () {
            var typeCode = $('input:radio[name=TypeCodeArea]:checked').val();
            DepartmentIndex.AreaTypeCodeSelected = typeCode;
            if (typeCode == 'all-area') {
                $('#allTypeArea').show();
                $('#oneTypeArea').hide();

                var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
                if (!!dept && dept.DepartOnlyCode > 0) {
                    if ($("#treeTableArea tbody").children().length > 0) {
                        PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': ['area-fy-sel', 'area-fy-modify', 'area-cust-sel', 'area-fy-info'], 'ViewType': 1 }, true, function (result) {
                            var data = [];
                            if (!!result) {
                                data = result.Data;
                            }
                            DepartmentIndex.BatchRefreshUplusAreaCanSeeSelectedNodes(data);
                            $('input:checkbox[TypeCodeArea="area-fy-sel"]').prop('checked', false);
                            $('input:checkbox[TypeCodeArea="area-fy-modify"]').prop('checked', false);
                            $('input:checkbox[TypeCodeArea="area-cust-sel"]').prop('checked', false);
                            $('input:checkbox[TypeCodeArea="area-fy-info"]').prop('checked', false);
                            DepartmentIndex.SetTreeTableAreaStatus(DepartmentIndex.UplusAreaCanSeeSelectedNodes);
                            layui.use('form', function () {
                                layui.form.render('checkbox');
                            });
                        });
                    }
                }

            } else {
                $('#allTypeArea').hide();
                $('#oneTypeArea').show();

                var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
                if (!!dept && dept.DepartOnlyCode > 0) {
                    var areaDataTree = $.fn.zTree.getZTreeObj("areaDataTree");
                    if (!!areaDataTree) {
                        PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaCanSee').val(), 'DepartOnlyCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 1 }, true, function (result) {
                            areaDataTree.checkAllNodes(false);
                            var data = [];
                            if (!!result) {
                                for (var i = 0; i < result.Data.length; i++) {
                                    var node = areaDataTree.getNodeByParam("DataCode", result.Data[i].DataCode);
                                    if (node != null) {
                                        areaDataTree.checkNode(node, true);
                                    }
                                };
                                data = result.Data;
                            }
                            DepartmentIndex.RefreshUplusAreaCanSeeSelectedNodes(typeCode, data);
                        });
                    }
                }
            }
        });

        $('#CityAreaCanSee').val(CacheHelper.GetUser().CityID);
        cityAreaCanSeeChange();
        DepartmentIndex.InitUplusDistrict(form);
    },
    InitUplusAreaBeSeen: function (form) {
        //U+片区权限能看我的
        ControlComm.CityBinding($('#CityAreaBeSeen'), form);
        $('input:radio[name=TypeCodeAreaBeSeen][value="area-fy-sel"]').prop("checked", true);
        var cityAreaBeSeenChange = function () {
            ControlComm.AreaBinding($('#DepartmentAreaBeSeen'), form, $('#CityAreaBeSeen').val());
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                var typeCode = $('input:radio[name=TypeCodeAreaBeSeen]:checked').val();
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptBeSeen').val(), 'DataCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 2 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusAreaBeSeenSelectedNodes(typeCode, data);
                    ControlComm.GetAreaTree($('#areaDataTreeBeSeen'), $('#CityAreaBeSeen').val(), DepartmentIndex.GetUplusAreaBeSeenSelectedNodesByTypeCode(typeCode));
                });
            } else {
                ControlComm.GetAreaTree($('#areaDataTreeBeSeen'), $('#CityAreaBeSeen').val());
            }
        };

        form.on('select(CityAreaBeSeen)', cityAreaBeSeenChange);
        form.on('select(DepartmentAreaBeSeen)', function () {
            var listSorted = $('#DepartmentAreaBeSeen').val() == '' ? null : DepartmentIndex.GetAreaTreeListSorted($('#DepartmentAreaBeSeen').find('option:selected').eq(0), CacheHelper.GetArea($('#CityAreaBeSeen').val()));

            var typeCode = $('input:radio[name=TypeCodeAreaBeSeen]:checked').val();
            var arrArea = DepartmentIndex.GetUplusAreaBeSeenSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshAreaSelectedNodes("areaDataTreeBeSeen", arrArea);
            ControlComm.GetAreaTree($('#areaDataTreeBeSeen'), $('#CityAreaBeSeen').val(), arrArea, listSorted);
        });
        $('#SaveTypeCodeAreaBeSeen').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }

            var typeCode = $('input:radio[name=TypeCodeAreaBeSeen]:checked').val();
            var paramName = DepartmentIndex.GetUplusAreaParamNameByTypeCode(typeCode);
            var arrArea = DepartmentIndex.GetUplusAreaBeSeenSelectedNodesByTypeCode(typeCode);
            DepartmentIndex.RefreshAreaSelectedNodes("areaDataTreeBeSeen", arrArea);
            var param = {};
            param.DataCode = dept.DepartOnlyCode;
            param.CityID = $('#CityDeptBeSeen').val();
            param[paramName] = arrArea;
            param.TypeCodeList = [typeCode];
            param.ViewType = 2;
            PublicComm.Ajax("POST", "/Authority/Privilege/SavePrivDepartment", param, true, function (result) {
                if (!!result) {
                    if (result.Code == 2000) {
                        layer.alert("保存成功");
                    } else {
                        layer.alert("保存失败，原因：" + result.Message);
                    }
                }
            });
        });
        $('#CheckedAllTypeCodeAreaBeSeen').on('click', function () {
            DepartmentIndex.CheckAllNodes("areaDataTreeBeSeen", true);
        });
        $('#UnCheckedAllTypeCodeAreaBeSeen').on('click', function () {
            DepartmentIndex.CheckAllNodes("areaDataTreeBeSeen", false);
        });



        //U+片区权限能看我的radio事件
        form.on('radio(TypeCodeAreaBeSeen)', function () {
            var typeCode = $('input:radio[name=TypeCodeAreaBeSeen]:checked').val();
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            if (!!dept && dept.DepartOnlyCode > 0) {
                var areaDataTreeBeSeen = $.fn.zTree.getZTreeObj("areaDataTreeBeSeen");
                if (!!areaDataTreeBeSeen) {
                    PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaBeSeen').val(), 'DataCode': dept.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 2 }, true, function (result) {
                        areaDataTreeBeSeen.checkAllNodes(false);
                        var data = [];
                        if (!!result) {
                            for (var i = 0; i < result.Data.length; i++) {
                                var node = areaDataTreeBeSeen.getNodeByParam("ID", result.Data[i].ID);
                                if (node != null) {
                                    areaDataTreeBeSeen.checkNode(node, true);
                                }
                            };
                            data = result.Data;
                        }
                        DepartmentIndex.RefreshUplusAreaBeSeenSelectedNodes(typeCode, data);
                    });
                }
            }
        });

        $('#CityAreaBeSeen').val(CacheHelper.GetUser().CityID);
        cityAreaBeSeenChange();
    },
    InitUplusDistrict: function (form) {
        $('#CopyTypeCodeArea').on('click', function () {
            var dept = DepartmentIndex.GetDeptTreeSelectedNodes();
            console.log(dept);
            if (!DepartmentIndex.ValidateDeptTreeSelected(dept)) {
                return;
            }
            DepartmentIndex.AreaDepartOnlyCodeSelected = dept.DepartOnlyCode;
            console.log(DepartmentIndex.AreaDepartOnlyCodeSelected);
            var treeObj = $.fn.zTree.getZTreeObj("areaDataTree");
            var CityID = $('#CityAreaCanSee').val();
            layui.use("layer", function () {
                var layer = layui.layer;
                layer.open({
                    type: 2,
                    title: '',
                    area: ['53%', '80%'], //宽高
                    content: 'department/department_copyareaprivtodep.html#' + CityID + '',
                    scrollbar: false,//禁用滚动条
                    btnAlign: 'd'
                });
            });
            //if (!!treeObj) {
            //	var CityID = $('#CityDeptCanSee').val();
            //	var DeptID = $("#DepartmentDeptCanSee").val();
            //	layui.use("layer", function () {
            //		var layer = layui.layer;
            //		layer.open({
            //			type: 2,
            //			title: '',
            //			area: ['53%', '80%'], //宽高
            //			content: 'department/department_copyareaprivtodep.html#' + CityID + '',
            //			scrollbar: false,//禁用滚动条
            //			btnAlign: 'd'
            //		});
            //	});
            //};
        });
    },
    /// <summary>
    /// 根据当前树选择节点刷新完整树选择的节点
    ///<param name="treeId">树id</param>
    ///<param name="arr">当前树选择的节点数组</param>
    /// </summary>/
    RefreshSelectedNodes: function (treeId, arr) {
        var zTreeObj = $.fn.zTree.getZTreeObj(treeId);
        if (!!zTreeObj) {
            var unCheckedNodes = zTreeObj.getCheckedNodes(false);
            layui.each(unCheckedNodes, function () {
                if (arr.indexOf(this.DepartOnlyCode) >= 0) {
                    arr.splice(arr.indexOf(this.DepartOnlyCode), 1);
                }
            });
            var checkedNodes = zTreeObj.getCheckedNodes(true);
            layui.each(checkedNodes, function () {
                if (arr.indexOf(this.DepartOnlyCode) == -1) {
                    arr.push(this.DepartOnlyCode);
                }
            });
        }
    },
    /// <summary>
    /// 根据当前树选择节点刷新完整树选择的节点
    ///<param name="treeId">树id</param>
    ///<param name="arr">当前树选择的节点数组</param>
    /// </summary>/
    RefreshAreaSelectedNodes: function (treeId, arr) {
        var zTreeObj = $.fn.zTree.getZTreeObj(treeId);
        if (!!zTreeObj) {
            var unCheckedNodes = zTreeObj.getCheckedNodes(false);
            layui.each(unCheckedNodes, function () {
                if (arr.indexOf(this.DataCode) >= 0) {
                    arr.splice(arr.indexOf(this.DataCode), 1);
                }
            });
            var checkedNodes = zTreeObj.getCheckedNodes(true);
            layui.each(checkedNodes, function () {
                if (arr.indexOf(this.DataCode) == -1) {
                    arr.push(this.DataCode);
                }
            });
        }
    },
    /// <summary>
    /// 根据treetable勾选数据更新缓存数据
    ///<param name="jsonDeptData">部门json数据</param>
    /// </summary>/
    RefreshTreeTableSelectedNodes: function (jsonDeptData) {
        layui.each($('input:checkbox[TypeCode="dep-fy-sel"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.FySel.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.FySel.splice(jsonDeptData.FySel.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-fy-sel"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.FySel.indexOf(departOnlyCode) == -1) {
                jsonDeptData.FySel.push(departOnlyCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-cust-sel"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.CustSel.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.CustSel.splice(jsonDeptData.CustSel.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-cust-sel"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.CustSel.indexOf(departOnlyCode) == -1) {
                jsonDeptData.CustSel.push(departOnlyCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-public-owner"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.PublicOwner.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.PublicOwner.splice(jsonDeptData.PublicOwner.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-public-owner"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.PublicOwner.indexOf(departOnlyCode) == -1) {
                jsonDeptData.PublicOwner.push(departOnlyCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-private-owner"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.PrivateOwner.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.PrivateOwner.splice(jsonDeptData.PrivateOwner.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-private-owner"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.PrivateOwner.indexOf(departOnlyCode) == -1) {
                jsonDeptData.PrivateOwner.push(departOnlyCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-common-owner"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.CommonOwner.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.CommonOwner.splice(jsonDeptData.CommonOwner.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-common-owner"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.CommonOwner.indexOf(departOnlyCode) == -1) {
                jsonDeptData.CommonOwner.push(departOnlyCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-fy-fellow"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.FyFellow.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.FyFellow.splice(jsonDeptData.FyFellow.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-fy-fellow"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.FyFellow.indexOf(departOnlyCode) == -1) {
                jsonDeptData.FyFellow.push(departOnlyCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-cust-fellow"]:not(:checked)'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.CustFellow.indexOf(departOnlyCode) >= 0) {
                jsonDeptData.CustFellow.splice(jsonDeptData.CustFellow.indexOf(departOnlyCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="dep-cust-fellow"]:checked'), function () {
            var departOnlyCode = parseInt($(this).attr('DepartOnlyCode'));
            if (jsonDeptData.CustFellow.indexOf(departOnlyCode) == -1) {
                jsonDeptData.CustFellow.push(departOnlyCode);
            }
        });
    },
    RefreshTreeTableAreaSelectedNodes: function (jsonAreaData) {
        layui.each($('input:checkbox[TypeCode="area-fy-sel"]:not(:checked)'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.FySel.indexOf(dataCode) >= 0) {
                jsonAreaData.FySel.splice(jsonAreaData.FySel.indexOf(dataCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-fy-sel"]:checked'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.FySel.indexOf(dataCode) == -1 && dataCode != -1) {
                jsonAreaData.FySel.push(dataCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-fy-modify"]:not(:checked)'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.FyModify.indexOf(dataCode) >= 0) {
                jsonAreaData.FyModify.splice(jsonAreaData.FyModify.indexOf(dataCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-fy-modify"]:checked'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.FyModify.indexOf(dataCode) == -1 && dataCode != -1) {
                jsonAreaData.FyModify.push(dataCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-cust-sel"]:not(:checked)'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.CustSel.indexOf(dataCode) >= 0) {
                jsonAreaData.CustSel.splice(jsonAreaData.CustSel.indexOf(dataCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-cust-sel"]:checked'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.CustSel.indexOf(dataCode) == -1 && dataCode != -1) {
                jsonAreaData.CustSel.push(dataCode);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-fy-info"]:not(:checked)'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.FyInfo.indexOf(dataCode) >= 0) {
                jsonAreaData.FyInfo.splice(jsonAreaData.FyInfo.indexOf(dataCode), 1);
            }
        });
        layui.each($('input:checkbox[TypeCode="area-fy-info"]:checked'), function () {
            var dataCode = parseInt($(this).attr('DataCode'));
            if (jsonAreaData.FyInfo.indexOf(dataCode) == -1 && dataCode != -1) {
                jsonAreaData.FyInfo.push(dataCode);
            }
        });
    },
    /// <summary>
    /// 调整ztree展开状态
    ///<param name="treeId">数id</param>
    ///<param name="bool">true全部展开，false全部关闭</param>
    /// </summary>/
    CheckAllNodes: function (treeId, bool) {
        var zTreeObj = $.fn.zTree.getZTreeObj(treeId);
        if (!!zTreeObj) {
            zTreeObj.checkAllNodes(bool);
        }
    },
    //初始化部门数，以及部门点击事件
    GetDeptTreeNoCheck: function (element, cityid, listSorted) {
        var zTree;
        //部门点击事件
        var zTreeOnClick = function (event, treeId, treeNode) {
            //门限管辖权限我能看的
            var TreeDivisitionCanSee = $.fn.zTree.getZTreeObj("TreeDivisitionCanSee");
            if (!!TreeDivisitionCanSee) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDivisitionCanSee').val(), 'DepartOnlyCode': treeNode.DepartOnlyCode, 'TypeCodeList': ['dep-divisition-sel'], 'ViewType': 1 }, true, function (result) {
                    DepartmentIndex.DivisitionCanSeeSelectedNodes = [];
                    TreeDivisitionCanSee.checkAllNodes(false);
                    if (!!result) {
                        for (var i = 0; i < result.Data.length; i++) {
                            var node = TreeDivisitionCanSee.getNodeByParam("DepartOnlyCode", result.Data[i].DataCode);
                            if (node != null) {
                                TreeDivisitionCanSee.checkNode(node, true);
                            }
                        };
                        layui.each(result.Data, function () {
                            DepartmentIndex.DivisitionCanSeeSelectedNodes.push(this.DataCode);
                        });
                    }
                });
            }

            //门限管辖权限能看我的
            var TreeDivisitionBeSeen = $.fn.zTree.getZTreeObj("TreeDivisitionBeSeen");
            if (!!TreeDivisitionBeSeen) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDivisitionBeSeen').val(), 'DataCode': treeNode.DepartOnlyCode, 'TypeCodeList': ['dep-divisition-sel'], 'ViewType': 2 }, true, function (result) {
                    DepartmentIndex.DivisitionBeSeenSelectedNodes = [];
                    TreeDivisitionBeSeen.checkAllNodes(false);
                    if (!!result) {
                        for (var i = 0; i < result.Data.length; i++) {
                            var node = TreeDivisitionBeSeen.getNodeByParam("DepartOnlyCode", result.Data[i].DepartOnlyCode);
                            if (node != null) {
                                TreeDivisitionBeSeen.checkNode(node, true);
                            }
                        };
                        layui.each(result.Data, function () {
                            DepartmentIndex.DivisitionBeSeenSelectedNodes.push(this.DataCode);
                        });
                    }
                });
            }

            //U+门店权限我能看的
            var typeCode = $('input:radio[name=TypeCode]:checked').val();
            var deptDataTree = $.fn.zTree.getZTreeObj("deptDataTree");
            if (!!deptDataTree) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': treeNode.DepartOnlyCode, 'TypeCodeList': [typeCode], 'ViewType': 1 }, true, function (result) {
                    deptDataTree.checkAllNodes(false);
                    var data = [];
                    if (!!result) {
                        for (var i = 0; i < result.Data.length; i++) {
                            var node = deptDataTree.getNodeByParam("DepartOnlyCode", result.Data[i].DataCode);
                            if (node != null) {
                                deptDataTree.checkNode(node, true);
                            }
                        };
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusCanSeeSelectedNodes(typeCode, data);
                });
            }
            if ($("#treeTable tbody").children().length > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DepartOnlyCode': treeNode.DepartOnlyCode, 'TypeCodeList': ['dep-fy-sel', 'dep-cust-sel', 'dep-public-owner', 'dep-private-owner', 'dep-common-owner', 'dep-fy-fellow', 'dep-cust-fellow'], 'ViewType': 1 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.BatchRefreshUplusCanSeeSelectedNodes(data);
                    $('input:checkbox[TypeCode="dep-fy-sel"]').prop('checked', false);
                    $('input:checkbox[TypeCode="dep-cust-sel"]').prop('checked', false);
                    $('input:checkbox[TypeCode="dep-public-owner"]').prop('checked', false);
                    $('input:checkbox[TypeCode="dep-private-owner"]').prop('checked', false);
                    $('input:checkbox[TypeCode="dep-common-owner"]').prop('checked', false);
                    $('input:checkbox[TypeCode="dep-fy-fellow"]').prop('checked', false);
                    $('input:checkbox[TypeCode="dep-cust-fellow"]').prop('checked', false);
                    DepartmentIndex.SetTreeTableStatus(DepartmentIndex.UplusCanSeeSelectedNodes);
                    layui.use('form', function () {
                        layui.form.render('checkbox');
                    });
                });
            }

            //U+门店权限能看我的
            var typeCodeBeSeen = $('input:radio[name=TypeCodeBeSeen]:checked').val();
            var deptDataTreeBeSeen = $.fn.zTree.getZTreeObj("deptDataTreeBeSeen");
            if (!!deptDataTreeBeSeen) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityDeptCanSee').val(), 'DataCode': treeNode.DepartOnlyCode, 'TypeCodeList': [typeCodeBeSeen], 'ViewType': 2 }, true, function (result) {
                    deptDataTreeBeSeen.checkAllNodes(false);
                    var data = [];
                    if (!!result) {
                        for (var i = 0; i < result.Data.length; i++) {
                            var node = deptDataTreeBeSeen.getNodeByParam("DepartOnlyCode", result.Data[i].DepartOnlyCode);
                            if (node != null) {
                                deptDataTreeBeSeen.checkNode(node, true);
                            }
                        };
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusBeSeenSelectedNodes(typeCodeBeSeen, data);
                });
            }

            //U+片区权限我能看的
            var typeCodeArea = $('input:radio[name=TypeCodeArea]:checked').val();
            var areaDataTree = $.fn.zTree.getZTreeObj("areaDataTree");
            if (!!areaDataTree) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaCanSee').val(), 'DepartOnlyCode': treeNode.DepartOnlyCode, 'TypeCodeList': [typeCodeArea], 'ViewType': 1 }, true, function (result) {
                    areaDataTree.checkAllNodes(false);
                    var data = [];
                    if (!!result) {
                        for (var i = 0; i < result.Data.length; i++) {
                            var node = areaDataTree.getNodeByParam("DataCode", result.Data[i].DataCode);
                            if (node != null) {
                                areaDataTree.checkNode(node, true);
                            }
                        };
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusAreaCanSeeSelectedNodes(typeCodeArea, data);
                });
            }
            if ($("#treeTableArea tbody").children().length > 0) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaCanSee').val(), 'DepartOnlyCode': treeNode.DepartOnlyCode, 'TypeCodeList': ['area-fy-sel', 'area-fy-modify', 'area-cust-sel', 'area-fy-info'], 'ViewType': 1 }, true, function (result) {
                    var data = [];
                    if (!!result) {
                        data = result.Data;
                    }
                    DepartmentIndex.BatchRefreshUplusAreaCanSeeSelectedNodes(data);
                    $('input:checkbox[TypeCodeArea="area-fy-sel"]').prop('checked', false);
                    $('input:checkbox[TypeCodeArea="area-fy-modify"]').prop('checked', false);
                    $('input:checkbox[TypeCodeArea="area-cust-sel"]').prop('checked', false);
                    $('input:checkbox[TypeCodeArea="area-fy-info"]').prop('checked', false);
                    DepartmentIndex.SetTreeTableAreaStatus(DepartmentIndex.UplusAreaCanSeeSelectedNodes);
                    layui.use('form', function () {
                        layui.form.render('checkbox');
                    });
                });
            }

            //U+门店权限能看我的
            var typeCodeAreaBeSeen = $('input:radio[name=TypeCodeAreaBeSeen]:checked').val();
            var areaDataTreeBeSeen = $.fn.zTree.getZTreeObj("areaDataTreeBeSeen");
            if (!!areaDataTreeBeSeen) {
                PublicComm.Ajax('POST', '/Authority/Privilege/GetPrivDepartmentList', { 'CityID': $('#CityAreaCanSee').val(), 'DataCode': treeNode.DepartOnlyCode, 'TypeCodeList': [typeCodeAreaBeSeen], 'ViewType': 2 }, true, function (result) {
                    areaDataTreeBeSeen.checkAllNodes(false);
                    var data = [];
                    if (!!result) {
                        for (var i = 0; i < result.Data.length; i++) {
                            var node = areaDataTreeBeSeen.getNodeByParam("ID", result.Data[i].ID);
                            if (node != null) {
                                areaDataTreeBeSeen.checkNode(node, true);
                            }
                        };
                        data = result.Data;
                    }
                    DepartmentIndex.RefreshUplusAreaBeSeenSelectedNodes(typeCodeAreaBeSeen, data);
                });
            }
        };
        var setting = {
            view: {
                selectedMulti: false
            },
            check: {
                enable: false,
                chkStyle: "checkbox",
                chkboxType: { "Y": "ps", "N": "ps" }
            },
            data: {
                simpleData: {
                    enable: true,
                    idKey: "DeptNo",
                    pIdKey: "ParentDeptNo",
                    rootPId: 0
                }
				,
                key: {
                    checked: "checked",
                    name: "DeptName",
                    id: "DepartOnlyCode"
                }
            },
            edit: {
                enable: false
            },
            callback: {    //第一步
                onClick: zTreeOnClick
            }
        };
        if (!!listSorted) {
            zTree = $.fn.zTree.init(element, setting, listSorted);
            zTree.expandAll(true);
        } else {
            if (!!CacheHelper.GetDepartment($('#City').val())) {
                zTree = $.fn.zTree.init(element, setting, CacheHelper.GetDepartment($('#City').val()));
                zTree.expandAll(true);
            } else {
                PublicComm.Ajax("POST", '/Authority/Department/GetDepartmentListByCity', { CityID: $('#City').val() }, true, function (result) {
                    CacheHelper.SetDepartment($('#City').val(), result.Data);
                    zTree = $.fn.zTree.init(element, setting, CacheHelper.GetDepartment($('#City').val()));
                    zTree.expandAll(true);
                });
            }
        }
    },
    //初始化部门treetable
    GetTreeTable: function (form, cityid, jsonDeptData, listSorted) {
        var InitTreeTable = function (listDept) {
            $("#treeTable tbody").html(DepartmentIndex.BuildDeptDataPermissionHTML(listDept));
            $("#treeTable").treetable({
                expandable: true,
                clickableNodeNames: true,
            }, true);
            //$("#treeTable").treetable("expandAll");//展开全部
            if (!!jsonDeptData) {
                DepartmentIndex.SetTreeTableStatus(jsonDeptData);
            }
            form.render();
        };
        if (!!listSorted) {
            InitTreeTable(listSorted);
        } else {
            if (!!CacheHelper.GetDepartment(cityid)) {
                InitTreeTable(CacheHelper.GetDepartment(cityid));
            } else {
                PublicComm.Ajax("POST", '/Authority/Department/GetDepartmentListByCity', { CityID: cityid }, true, function (result) {
                    CacheHelper.SetDepartment(cityid, result.Data);
                    InitTreeTable(CacheHelper.GetDepartment(cityid));
                });
            }
        }
    },
    //初始化部门treetable勾选状态
    SetTreeTableStatus: function (jsonDeptData) {
        layui.each(jsonDeptData.FySel, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-fy-sel"]').prop('checked', true);
        });
        layui.each(jsonDeptData.CustSel, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-cust-sel"]').prop('checked', true);
        });
        layui.each(jsonDeptData.PublicOwner, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-public-owner"]').prop('checked', true);
        });
        layui.each(jsonDeptData.PrivateOwner, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-private-owner"]').prop('checked', true);
        });
        layui.each(jsonDeptData.CommonOwner, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-common-owner"]').prop('checked', true);
        });
        layui.each(jsonDeptData.FyFellow, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-fy-fellow"]').prop('checked', true);
        });
        layui.each(jsonDeptData.CustFellow, function (index, item) {
            $('input:checkbox[DepartOnlyCode=' + item + '][TypeCode="dep-cust-fellow"]').prop('checked', true);
        });
    },
    //初始化片区treetable
    GetTreeTableArea: function (form, cityid, jsonAreaData, listSorted) {
        var InitTreeTable = function (listArea) {
            $("#treeTableArea tbody").html(DepartmentIndex.BuildAreaDataPermissionHTML(listArea));
            $("#treeTableArea").treetable({
                expandable: true,
                clickableNodeNames: true,
            }, true);
            //$("#treeTable").treetable("expandAll");//展开全部
            if (!!jsonAreaData) {
                DepartmentIndex.SetTreeTableAreaStatus(jsonAreaData);
            }
            $("#treeTableArea tbody tr td input:checkbox[DataCode=-1]").prop('disabled', true);
            form.render();
        };
        if (!!listSorted) {
            InitTreeTable(listSorted);
        } else {
            if (!!CacheHelper.GetArea(cityid)) {
                InitTreeTable(CacheHelper.GetArea(cityid));
            } else {
                PublicComm.Ajax("POST", '/Authority/Area/GetTreeAreaDistrictByCity', { CityID: cityid }, true, function (result) {
                    CacheHelper.SetArea(cityid, result.Data);
                    InitTreeTable(CacheHelper.GetArea(cityid));
                });
            }
        }
    },
    //初始化片区treetable勾选状态
    SetTreeTableAreaStatus: function (jsonAreaData) {
        layui.each(jsonAreaData.FySel, function (index, item) {
            $('input:checkbox[DataCode=' + item + '][TypeCodeArea="area-fy-sel"]').prop('checked', true);
        });
        layui.each(jsonAreaData.FyModify, function (index, item) {
            $('input:checkbox[DataCode=' + item + '][TypeCodeArea="area-fy-modify"]').prop('checked', true);
        });
        layui.each(jsonAreaData.CustSel, function (index, item) {
            $('input:checkbox[DataCode=' + item + '][TypeCodeArea="area-cust-sel"]').prop('checked', true);
        });
        layui.each(jsonAreaData.FyInfo, function (index, item) {
            $('input:checkbox[DataCode=' + item + '][TypeCodeArea="area-fy-info"]').prop('checked', true);
        });
    },
    /// <summary>
    /// 获取门店树所选择节点
    /// </summary>
    GetDeptTreeSelectedNodes: function () {
        var zTreeObj = $.fn.zTree.getZTreeObj("deptTree");
        if (!zTreeObj) {
            return null;
        }
        var selectedNodes = zTreeObj.getSelectedNodes();
        return (!!selectedNodes && selectedNodes.length > 0) ? selectedNodes[0] : null;
    },
    /// <summary>
    /// 判断门店树是否选择一个部门
    ///<param name="node">当前选择节点</param>
    /// </summary>
    ValidateDeptTreeSelected: function (node) {
        if (!node) {
            layui.use('layer', function () {
                var layer = layui.layer;
                layer.alert("请选择一个部门");
            });
            return false;
        }
        return true;
    },
    GetUplusCanSeeSelectedNodesByTypeCode: function (typeCode) {
        switch (typeCode) {
            case 'dep-fy-sel':
                return DepartmentIndex.FySelCanSeeSelectedNodes;
            case 'dep-cust-sel':
                return DepartmentIndex.CustSelCanSeeSelectedNodes;
            case 'dep-public-owner':
                return DepartmentIndex.PublicOwnerCanSeeSelectedNodes;
            case 'dep-private-owner':
                return DepartmentIndex.PrivateOwnerCanSeeSelectedNodes;
            case 'dep-common-owner':
                return DepartmentIndex.CommonOwnerCanSeeSelectedNodes;
            case 'dep-fy-fellow':
                return DepartmentIndex.FyFellowCanSeeSelectedNodes;
            case 'dep-cust-fellow':
                return DepartmentIndex.CustFellowCanSeeSelectedNodes;
        }
        return [];
    },
    GetUplusBeSeenSelectedNodesByTypeCode: function (typeCode) {
        switch (typeCode) {
            case 'dep-fy-sel':
                return DepartmentIndex.FySelBeSeenSelectedNodes;
            case 'dep-cust-sel':
                return DepartmentIndex.CustSelBeSeenSelectedNodes;
            case 'dep-public-owner':
                return DepartmentIndex.PublicOwnerBeSeenSelectedNodes;
            case 'dep-private-owner':
                return DepartmentIndex.PrivateOwnerBeSeenSelectedNodes;
            case 'dep-common-owner':
                return DepartmentIndex.CommonOwnerBeSeenSelectedNodes;
            case 'dep-fy-fellow':
                return DepartmentIndex.FyFellowBeSeenSelectedNodes;
            case 'dep-cust-fellow':
                return DepartmentIndex.CustFellowBeSeenSelectedNodes;
        }
        return [];
    },
    GetUplusParamNameByTypeCode: function (typeCode) {
        switch (typeCode) {
            case 'dep-fy-sel':
                return 'DepFySel';
            case 'dep-cust-sel':
                return 'DepCustSel';
            case 'dep-public-owner':
                return 'DepPublicOwner';
            case 'dep-private-owner':
                return 'DepPrivateOwner';
            case 'dep-common-owner':
                return 'DepCommonOwner';
            case 'dep-fy-fellow':
                return 'DepFyFellow';
            case 'dep-cust-fellow':
                return 'DepCustFellow';
        }
        return '';
    },
    ///<summary>
    ///刷新U+门店权限选择我能看的
    ///</summary>
    ///<param name="typeCode">选择的数据类型</param>
    ///<param name="data">返回的数据</param>
    ///<return></return>
    RefreshUplusCanSeeSelectedNodes: function (typeCode, data) {
        switch (typeCode) {
            case 'dep-fy-sel':
                DepartmentIndex.FySelCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.FySelCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.FySelCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'dep-cust-sel':
                DepartmentIndex.CustSelCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.CustSelCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.CustSelCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'dep-public-owner':
                DepartmentIndex.PublicOwnerCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.PublicOwnerCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.PublicOwnerCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'dep-private-owner':
                DepartmentIndex.PrivateOwnerCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.PrivateOwnerCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.PrivateOwnerCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'dep-common-owner':
                DepartmentIndex.CommonOwnerCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.CommonOwnerCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.CommonOwnerCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'dep-fy-fellow':
                DepartmentIndex.FyFellowCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.FyFellowCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.FyFellowCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'dep-cust-fellow':
                DepartmentIndex.CustFellowCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.CustFellowCanSeeSelectedNodes.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.CustFellowCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
        }
    },
    ///<summary>
    ///刷新U+门店权限选择能看我的
    ///</summary>
    ///<param name="typeCode">选择的数据类型</param>
    ///<param name="data">返回的数据</param>
    ///<return></return>
    RefreshUplusBeSeenSelectedNodes: function (typeCode, data) {
        switch (typeCode) {
            case 'dep-fy-sel':
                DepartmentIndex.FySelBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.FySelBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.FySelBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'dep-cust-sel':
                DepartmentIndex.CustSelBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.CustSelBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.CustSelBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'dep-public-owner':
                DepartmentIndex.PublicOwnerBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.PublicOwnerBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.PublicOwnerBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'dep-private-owner':
                DepartmentIndex.PrivateOwnerBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.PrivateOwnerBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.PrivateOwnerBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'dep-common-owner':
                DepartmentIndex.CommonOwnerBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.CommonOwnerBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.CommonOwnerBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'dep-fy-fellow':
                DepartmentIndex.FyFellowBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.FyFellowBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.FyFellowBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'dep-cust-fellow':
                DepartmentIndex.CustFellowBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.CustFellowBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1) {
                        DepartmentIndex.CustFellowBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
        }
    },
    ///<summary>
    ///批量刷新U+门店权限选择我能看的
    ///</summary>
    ///<param name="data">返回的数据</param>
    ///<return></return>
    BatchRefreshUplusCanSeeSelectedNodes: function (data) {
        DepartmentIndex.UplusCanSeeSelectedNodes = { FySel: [], CustSel: [], PublicOwner: [], PrivateOwner: [], CommonOwner: [], FyFellow: [], CustFellow: [] };
        layui.each(data, function () {
            switch (this.TypeCode) {
                case 'dep-fy-sel':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.FySel.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.FySel.push(this.DataCode);
                    }
                    break;
                case 'dep-cust-sel':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.CustSel.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.CustSel.push(this.DataCode);
                    }
                    break;
                case 'dep-public-owner':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.PublicOwner.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.PublicOwner.push(this.DataCode);
                    }
                    break;
                case 'dep-private-owner':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.PrivateOwner.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.PrivateOwner.push(this.DataCode);
                    }
                    break;
                case 'dep-common-owner':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.CommonOwner.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.CommonOwner.push(this.DataCode);
                    }
                    break;
                case 'dep-fy-fellow':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.FyFellow.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.FyFellow.push(this.DataCode);
                    }
                    break;
                case 'dep-cust-fellow':
                    if (DepartmentIndex.UplusCanSeeSelectedNodes.CustFellow.indexOf(this.DataCode) == -1) {
                        DepartmentIndex.UplusCanSeeSelectedNodes.CustFellow.push(this.DataCode);
                    }
                    break;
            }
        });
    },
    GetUplusAreaCanSeeSelectedNodesByTypeCode: function (typeCode) {

        switch (typeCode) {
            case 'area-fy-sel':
                return DepartmentIndex.AreaFySelCanSeeSelectedNodes;
            case 'area-fy-modify':
                return DepartmentIndex.AreaFyModifyCanSeeSelectedNodes;
            case 'area-cust-sel':
                return DepartmentIndex.AreaCustSelCanSeeSelectedNodes;
            case 'area-fy-info':
                return DepartmentIndex.AreaFyInfoCanSeeSelectedNodes;
        }
        return [];
    },
    GetUplusAreaBeSeenSelectedNodesByTypeCode: function (typeCode) {
        switch (typeCode) {
            case 'area-fy-sel':
                return DepartmentIndex.AreaFySelBeSeenSelectedNodes;
            case 'area-fy-modify':
                return DepartmentIndex.AreaFyModifyBeSeenSelectedNodes;
            case 'area-cust-sel':
                return DepartmentIndex.AreaCustSelBeSeenSelectedNodes;
            case 'area-fy-info':
                return DepartmentIndex.AreaFyInfoBeSeenSelectedNodes;
        }
        return [];
    },
    GetUplusAreaParamNameByTypeCode: function (typeCode) {
        switch (typeCode) {
            case 'area-fy-sel':
                return 'AreaFySel';
            case 'area-fy-modify':
                return 'AreaFyModify';
            case 'area-cust-sel':
                return 'AreaCustSel';
            case 'area-fy-info':
                return 'AreaFyInfo';
        }
        return '';
    },
    ///<summary>
    ///刷新U+片区权限选择我能看的
    ///</summary>
    ///<param name="typeCode">选择的数据类型</param>
    ///<param name="data">返回的数据</param>
    ///<return></return>
    RefreshUplusAreaCanSeeSelectedNodes: function (typeCode, data) {
        switch (typeCode) {
            case 'area-fy-sel':
                DepartmentIndex.AreaFySelCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaFySelCanSeeSelectedNodes.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaFySelCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'area-fy-modify':
                DepartmentIndex.AreaFyModifyCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaFyModifyCanSeeSelectedNodes.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaFyModifyCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'area-cust-sel':
                DepartmentIndex.AreaCustSelCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaCustSelCanSeeSelectedNodes.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaCustSelCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
            case 'area-fy-info':
                DepartmentIndex.AreaFyInfoCanSeeSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaFyInfoCanSeeSelectedNodes.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaFyInfoCanSeeSelectedNodes.push(this.DataCode);
                    }
                });
                break;
        }
    },
    ///<summary>
    ///刷新U+片区权限选择能看我的
    ///</summary>
    ///<param name="typeCode">选择的数据类型</param>
    ///<param name="data">返回的数据</param>
    ///<return></return>
    RefreshUplusAreaBeSeenSelectedNodes: function (typeCode, data) {
        switch (typeCode) {
            case 'area-fy-sel':
                DepartmentIndex.AreaFyInfoBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaFyInfoBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaFyInfoBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'area-fy-modify':
                DepartmentIndex.AreaFyModifyBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaFyModifyBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaFyModifyBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'area-cust-sel':
                DepartmentIndex.AreaCustSelBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaCustSelBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaCustSelBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
            case 'area-fy-info':
                DepartmentIndex.AreaFyInfoBeSeenSelectedNodes = [];
                layui.each(data, function () {
                    if (DepartmentIndex.AreaFyInfoBeSeenSelectedNodes.indexOf(this.DepartOnlyCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.AreaFyInfoBeSeenSelectedNodes.push(this.DepartOnlyCode);
                    }
                });
                break;
        }
    },
    ///<summary>
    ///批量刷新U+片区权限选择我能看的
    ///</summary>
    ///<param name="data">返回的数据</param>
    ///<return></return>
    BatchRefreshUplusAreaCanSeeSelectedNodes: function (data) {
        DepartmentIndex.UplusAreaCanSeeSelectedNodes = { FySel: [], FyModify: [], CustSel: [], FyInfo: [] };
        layui.each(data, function () {
            switch (this.TypeCode) {
                case 'area-fy-sel':
                    if (DepartmentIndex.UplusAreaCanSeeSelectedNodes.FySel.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.UplusAreaCanSeeSelectedNodes.FySel.push(this.DataCode);
                    }
                    break;
                case 'area-fy-modify':
                    if (DepartmentIndex.UplusAreaCanSeeSelectedNodes.FyModify.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.UplusAreaCanSeeSelectedNodes.FyModify.push(this.DataCode);
                    }
                    break;
                case 'area-cust-sel':
                    if (DepartmentIndex.UplusAreaCanSeeSelectedNodes.CustSel.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.UplusAreaCanSeeSelectedNodes.CustSel.push(this.DataCode);
                    }
                    break;
                case 'area-fy-info':
                    if (DepartmentIndex.UplusAreaCanSeeSelectedNodes.FyInfo.indexOf(this.DataCode) == -1 && this.DataCode != -1) {
                        DepartmentIndex.UplusAreaCanSeeSelectedNodes.FyInfo.push(this.DataCode);
                    }
                    break;
            }
        });
    },
    /// <summary>
    /// 根据treetable排序规则拼写HTML
    /// </summary>
    BuildDeptDataPermissionHTML: function (jsonArr) {
        var strHTML = '';//HTML字符串
        if (!jsonArr.length) {
            return strHTML;
        }
        //var listSorted = [];//根据reetable排序规则排序的json数组
        ////根据父节点升序排序，0为根节点
        //jsonArr = jsonArr.sort(function (a, b) {
        //    return a.ParentDeptNo - b.ParentDeptNo;
        //});
        ////递归查找子节点
        //jsonArr.forEach(function (item) {
        //    DepartmentIndex.DeptSortNodeInfo(item, jsonArr, listSorted);
        //});
        jsonArr.forEach(function (item) {
            strHTML += '<tr data-tt-id="' + item.DeptNo + '"  data-tt-parent-id="' + item.ParentDeptNo + '">';
            strHTML += '<td>' + item.DeptName + '</td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-fy-sel"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-cust-sel"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-public-owner"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-private-owner"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-common-owner"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-fy-fellow"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DepartOnlyCode="' + item.DepartOnlyCode + '" TypeCode="dep-cust-fellow"></td>';
            strHTML += '</tr>';
        });
        return strHTML;
    },
    /// <summary>
    /// 根据treetable排序规则递归添加json数组
    /// </summary>
    DeptSortNodeInfo: function (obj, jsonArr, listSorted) {
        //去重，已经存在直接跳过
        if (listSorted.indexOf(obj) >= 0) {
            return;
        }
        listSorted.push(obj);
        delete jsonArr[jsonArr.indexOf(obj)];
        if (!obj.DeptNo) {
            return;
        }
        //递归查找子节点
        jsonArr.forEach(function (item) {
            if (obj.ID == item.ParentDeptNo) {
                DepartmentIndex.DeptSortNodeInfo(item, jsonArr, listSorted);
            }
        });
    },
    /// <summary>
    /// 根据treetable排序规则拼写HTML
    /// </summary>
    BuildAreaDataPermissionHTML: function (jsonArr) {
        var strHTML = '';//HTML字符串
        if (!jsonArr.length) {
            return strHTML;
        }
        jsonArr.forEach(function (item) {
            strHTML += '<tr data-tt-id="' + item.ID + '"  data-tt-parent-id="' + item.ParentID + '">';
            strHTML += '<td>' + item.Name + '</td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DataCode="' + item.DataCode + '" TypeCodeArea="area-fy-sel"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DataCode="' + item.DataCode + '" TypeCodeArea="area-fy-modify"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DataCode="' + item.DataCode + '" TypeCodeArea="area-cust-sel"></td>';
            strHTML += '<td><input type="checkbox" lay-skin="primary" DataCode="' + item.DataCode + '" TypeCodeArea="area-fy-info"></td>';
            strHTML += '</tr>';
        });
        return strHTML;
    },
    ///<summary>
    ///获取ztree所有父节点
    ///</summary>
    ///<param name="parentDeptNo">当前节点的parentDeptNo</param>
    ///<param name="deptList">树的所有节点</param>
    ///<param name="listSorted">返回节点集合</param>
    ///<return></return>
    GetParentNode: function (parentDeptNo, deptList, listSorted) {
        if (DepartmentIndex.IsContain(parentDeptNo, listSorted)) {
            return;
        }
        for (var i = 0; i < deptList.length; i++) {
            if (parentDeptNo == deptList[i].DeptNo) {
                listSorted.push(deptList[i]);
                DepartmentIndex.GetParentNode(deptList[i].ParentDeptNo, deptList, listSorted);
            }
        }
    },
    ///<summary>
    ///获取ztree所有子节点
    ///</summary>
    ///<param name="deptno">当前节点的deptno</param>
    ///<param name="deptList">树的所有节点</param>
    ///<param name="listSorted">返回节点集合</param>
    ///<return></return>
    GetChildNode: function (deptno, deptList, listSorted) {
        //if (DepartmentIndex.IsContain(deptno, listSorted)) {
        //	return;
        //}
        for (var i = 0; i < deptList.length; i++) {
            if (deptno == deptList[i].DeptNo) {
                if (listSorted.indexOf(deptList[i]) <= 0) {
                    listSorted.push(deptList[i]);
                }
            }
            if (deptno == deptList[i].ParentDeptNo) {
                listSorted.push(deptList[i]);
                DepartmentIndex.GetChildNode(deptList[i].DeptNo, deptList, listSorted);
            }
        }
    },
    IsContain: function (deptNo, listSorted) {
        for (var i = 0; i < listSorted.length; i++) {
            if (deptNo == listSorted[i].DeptNo) {
                return true;
            }
        }
        return false;
    },
    ///<summary>
    ///获取ztree所有父节点
    ///</summary>
    ///<param name="parentID">当前节点的parentID</param>
    ///<param name="areaList">树的所有节点</param>
    ///<param name="listSorted">返回节点集合</param>
    ///<return></return>
    GetAreaParentNode: function (parentID, areaList, listSorted) {
        if (DepartmentIndex.IsContainAreaTree(parentID, listSorted)) {
            return;
        }
        for (var i = 0; i < areaList.length; i++) {
            if (parentID == areaList[i].ID) {
                listSorted.push(areaList[i]);
                DepartmentIndex.GetAreaParentNode(areaList[i].ParentID, areaList, listSorted);
            }
        }
    },
    ///<summary>
    ///获取ztree所有子节点
    ///</summary>
    ///<param name="id">当前节点的id</param>
    ///<param name="deptList">树的所有节点</param>
    ///<param name="listSorted">返回节点集合</param>
    ///<return></return>
    GetAreaChildNode: function (id, areaList, listSorted) {
        //if (DepartmentIndex.IsContain(deptno, listSorted)) {
        //	return;
        //}
        for (var i = 0; i < areaList.length; i++) {
            if (id == areaList[i].ID) {
                if (listSorted.indexOf(areaList[i]) <= 0) {
                    listSorted.push(areaList[i]);
                }
            }
            if (id == areaList[i].ParentID) {
                listSorted.push(areaList[i]);
                DepartmentIndex.GetChildNode(areaList[i].ID, areaList, listSorted);
            }
        }
    },
    IsContainAreaTree: function (id, listSorted) {
        for (var i = 0; i < listSorted.length; i++) {
            if (id == listSorted[i].ID) {
                return true;
            }
        }
        return false;
    },
    ///<summary>
    ///获取ztree所有子节点
    ///</summary>
    ///<param name="dept">选择的部门</param>
    ///<param name="deptList">树的所有节点</param>
    ///<return>返回选择部门的节点集合</return>
    GetTreeListSorted: function (dept, deptList) {
        var listSorted = [];
        DepartmentIndex.GetParentNode($(dept).attr('ParentDeptNo'), deptList, listSorted);
        DepartmentIndex.GetChildNode($(dept).attr('DeptNo'), deptList, listSorted);
        return listSorted;
    },
    ///<summary>
    ///获取ztree所有子节点
    ///</summary>
    ///<param name="area">选择的片区</param>
    ///<param name="deptList">树的所有节点</param>
    ///<return>返回选择部门的节点集合</return>
    GetAreaTreeListSorted: function (area, areaList) {
        var listSorted = [];
        console.log($(area).attr('ParentID'));
        console.log($(area).attr('ID'));
        DepartmentIndex.GetAreaParentNode($(area).attr('ParentID'), areaList, listSorted);
        DepartmentIndex.GetAreaChildNode($(area).attr('ID'), areaList, listSorted);
        return listSorted;
    },
}

$(function () {
    DepartmentIndex.Init();
});
